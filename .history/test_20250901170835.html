<!DOCTYPE html>
<html>

<head>
    <title>JIRA Story Point Calculator - Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .test-case {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ccc;
        }

        .success {
            background: #d4edda;
            border-color: #c3e6cb;
        }

        .error {
            background: #f8d7da;
            border-color: #f5c6cb;
        }

        .input {
            font-weight: bold;
            color: #007bff;
        }

        .output {
            font-weight: bold;
            color: #28a745;
        }
    </style>
</head>

<body>
    <h1>üß™ JIRA Story Point Calculator - Test Suite</h1>

    <div id="testResults"></div>

    <script>
        // Copy the time parsing logic from content.js for testing
        function parseTimeToHours(timeString) {
            if (!timeString) return null;

            timeString = timeString.replace(/\s+/g, ' ').trim();

            const patterns = [
                /^(\d+(?:\.\d+)?)m$/i,
                /^(\d+(?:\.\d+)?)h\s+(\d+(?:\.\d+)?)m$/i,
                /^(\d+(?:\.\d+)?)h$/i,
                /^(\d+(?:\.\d+)?)m$/i
            ];

            for (let i = 0; i < patterns.length; i++) {
                const match = timeString.match(patterns[i]);
                if (match) {
                    switch (i) {
                        case 0: return parseFloat(match[1]) / 60;
                        case 1:
                            const hours = parseFloat(match[1]);
                            const minutes = parseFloat(match[2]);
                            return hours + (minutes / 60);
                        case 2: return parseFloat(match[1]);
                        case 3: return parseFloat(match[1]) / 60;
                    }
                }
            }

            const decimalMatch = timeString.match(/^(\d+(?:\.\d+)?)$/);
            if (decimalMatch) {
                return parseFloat(decimalMatch[1]);
            }

            return null;
        }

        function calculateTW(timeTracking, complexity) {
            const result = timeTracking * complexity;
            return Math.round(result * 100) / 100;
        }

        // Test cases
        const testCases = [
            { time: "25m", complexity: 0.3, expected: 0.13 },
            { time: "1h 15m", complexity: 0.6, expected: 0.75 },
            { time: "2.5h", complexity: 1.5, expected: 3.75 },
            { time: "90m", complexity: 0.2, expected: 0.30 },
            { time: "1.5", complexity: 1, expected: 1.50 },
            { time: "45m", complexity: 0.1, expected: 0.08 },
            { time: "3h 30m", complexity: 2, expected: 7.00 }
        ];

        function runTests() {
            const resultsDiv = document.getElementById('testResults');
            let html = '<h2>Test Results:</h2>';

            testCases.forEach((testCase, index) => {
                const parsedTime = parseTimeToHours(testCase.time);
                const calculated = calculateTW(parsedTime, testCase.complexity);
                const isSuccess = Math.abs(calculated - testCase.expected) < 0.01;

                html += `
                    <div class="test-case ${isSuccess ? 'success' : 'error'}">
                        <strong>Test ${index + 1}:</strong><br>
                        <span class="input">Input:</span> Time: "${testCase.time}" (${parsedTime}h), Complexity: ${testCase.complexity}<br>
                        <span class="output">Expected:</span> ${testCase.expected}<br>
                        <span class="output">Calculated:</span> ${calculated}<br>
                        <span class="output">Status:</span> ${isSuccess ? '‚úÖ PASS' : '‚ùå FAIL'}
                    </div>
                `;
            });

            resultsDiv.innerHTML = html;
        }

        // Run tests when page loads
        window.onload = runTests;
    </script>
</body>

</html>